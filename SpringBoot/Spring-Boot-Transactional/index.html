<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.1.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" integrity="sha256-jTIdiMuX/e3DGJUGwl3pKSxuc6YOuqtJYkM0bGQESA4=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":false,"version":"8.10.1","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="@Transactional annotation is used to define the scope of a single database transaction. If there is an exception thrown in the method, the transaction is rolled back. If the method completes successfu">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Boot - @Transactional">
<meta property="og:url" content="http://example.com/SpringBoot/Spring-Boot-Transactional/index.html">
<meta property="og:site_name" content="Xing&#39;s Blog">
<meta property="og:description" content="@Transactional annotation is used to define the scope of a single database transaction. If there is an exception thrown in the method, the transaction is rolled back. If the method completes successfu">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-07-13T22:39:00.000Z">
<meta property="article:modified_time" content="2024-07-13T22:39:00.000Z">
<meta property="article:author" content="Xinghua Zhang">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/SpringBoot/Spring-Boot-Transactional/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/SpringBoot/Spring-Boot-Transactional/","path":"SpringBoot/Spring-Boot-Transactional/","title":"Spring Boot - @Transactional"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Spring Boot - @Transactional | Xing's Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Xing's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Transactional"><span class="nav-number">1.</span> <span class="nav-text">@Transactional</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Propagation"><span class="nav-number">2.</span> <span class="nav-text">Propagation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#REQUIRED"><span class="nav-number">2.1.</span> <span class="nav-text">REQUIRED</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REQUIRES-NEW"><span class="nav-number">2.2.</span> <span class="nav-text">REQUIRES_NEW</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NESTED"><span class="nav-number">2.3.</span> <span class="nav-text">NESTED</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Difference-between-NESTED-and-REQUIRES-NEW"><span class="nav-number">2.4.</span> <span class="nav-text">Difference between NESTED and REQUIRES_NEW</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NOT-SUPPORTED"><span class="nav-number">2.5.</span> <span class="nav-text">NOT_SUPPORTED</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NEVER"><span class="nav-number">2.6.</span> <span class="nav-text">NEVER</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Isolation"><span class="nav-number">3.</span> <span class="nav-text">Isolation</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Read-Only"><span class="nav-number">4.</span> <span class="nav-text">Read-Only</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#rollbackFor"><span class="nav-number">5.</span> <span class="nav-text">rollbackFor</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#transactionManagers"><span class="nav-number">6.</span> <span class="nav-text">transactionManagers</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Spring-Transaction-or-Jakarta-Transaction"><span class="nav-number">7.</span> <span class="nav-text">Spring Transaction or Jakarta Transaction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CrudRepository-and-Transactional"><span class="nav-number">8.</span> <span class="nav-text">CrudRepository and @Transactional</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Swallowing-Exception"><span class="nav-number">9.</span> <span class="nav-text">Swallowing Exception</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Example-of-a-Problematic-Approach"><span class="nav-number">9.1.</span> <span class="nav-text">Example of a Problematic Approach</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#How-to-Handle-Exceptions-Properly-in-a-Transactional-Method"><span class="nav-number">9.2.</span> <span class="nav-text">How to Handle Exceptions Properly in a Transactional Method</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conclusion"><span class="nav-number">10.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-number">11.</span> <span class="nav-text">Reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xinghua Zhang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">253</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">27</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/xinghua24" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xinghua24" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/SpringBoot/Spring-Boot-Transactional/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xinghua Zhang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xing's Blog">
      <meta itemprop="description" content="">
    </span>
    
    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Spring Boot - @Transactional | Xing's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Spring Boot - @Transactional
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-07-13 18:39:00" itemprop="dateCreated datePublished" datetime="2024-07-13T18:39:00-04:00">2024-07-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Spring-Boot/" itemprop="url" rel="index"><span itemprop="name">Spring Boot</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>@Transactional annotation is used to define the scope of a single database transaction. If there is an exception thrown in the method, the transaction is rolled back. If the method completes successfully, the transaction is committed.</p>
<span id="more"></span>
<h1 id="Transactional"><a href="#Transactional" class="headerlink" title="@Transactional"></a>@Transactional</h1><p>When used on a class, it applies to all the public methods in the class. When used on a method, it applies only to that method. </p>
<p>When you are have database operations such as insert, update, delete, you should use @Transactional annotation to ensure that the operations are executed within a single transaction. This ensures that the operations are atomic, consistent, isolated, and durable (ACID). If there is no transactional support, each operation will be executed in its own transaction, which can lead to inconsistent data and potential data corruption.</p>
<p>The default @Transactional settings are as follows:</p>
<ul>
<li>The propagation setting is PROPAGATION_REQUIRED.</li>
<li>The isolation level is ISOLATION_DEFAULT.</li>
<li>The transaction is read-write.</li>
<li>The transaction timeout defaults to the default timeout of the underlying transaction system, or to none if timeouts are not supported.</li>
<li>Any RuntimeException or Error triggers rollback, and any checked Exception does not.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">   customerRepository.save(<span class="keyword">new</span> <span class="title class_">Customer</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Smith&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>If the saveCustomer method throws an exception, the transaction is rolled back. If the method completes successfully, the transaction is committed.</p>
<h1 id="Propagation"><a href="#Propagation" class="headerlink" title="Propagation"></a>Propagation</h1><p>The propagation setting is used to define the transaction boundaries. The following are the propagation settings:</p>
<ul>
<li>REQUIRED - If a transaction exists, use it. If no transaction exists, create a new one.</li>
<li>SUPPORTS - If a transaction exists, use it. If no transaction exists, run without a transaction.</li>
<li>MANDATORY - If a transaction exists, use it. If no transaction exists, throw an exception.</li>
<li>REQUIRES_NEW - Always create a new transaction.</li>
<li>NOT_SUPPORTED - Run without a transaction. If a transaction exists, suspend it.</li>
<li>NEVER - Run without a transaction. If a transaction exists, throw an exception.</li>
<li>NESTED - If a transaction exists, create a nested transaction. If no transaction exists, create a new transaction.</li>
</ul>
<p>default propagation is REQUIRED.</p>
<p>setting propagation to REQUIRES_NEW</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">  customerRepository.save(<span class="keyword">new</span> <span class="title class_">Customer</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Smith&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="REQUIRED"><a href="#REQUIRED" class="headerlink" title="REQUIRED"></a>REQUIRED</h2><p>This is the default propagation setting. Setting propagation &#x3D; Propagation.REQUIRED indicates that the annotated method should run within a transaction. If there is an existing transaction, the method will run within that transaction. If there is no existing transaction, a new transaction will be started.</p>
<h2 id="REQUIRES-NEW"><a href="#REQUIRES-NEW" class="headerlink" title="REQUIRES_NEW"></a>REQUIRES_NEW</h2><p>Setting propagation &#x3D; Propagation.REQUIRES_NEW indicates that the annotated method should always execute in a new transaction. If there is an existing transaction, it will be suspended and a new transaction will be started. Once the new transaction completes, the previous transaction will resume.</p>
<p>You should use REQUIRES_NEW in the following scenarios:</p>
<p><strong>Independent Operations</strong>: When you need the operations in the annotated method to be independent of the calling transaction. For instance, if the method needs to commit its changes regardless of the outer transaction’s outcome.</p>
<p><strong>Audit Logging</strong>: When logging actions need to be recorded even if the main transaction fails. This ensures that logs are written independently of the main transaction’s success or failure.</p>
<p><strong>Error Handling</strong>: When you need to ensure certain operations are completed even if the surrounding transaction is rolled back. For example, sending an email notification or updating a status flag.</p>
<p><strong>Isolation</strong>: When the method’s changes should not affect or be affected by the outer transaction. This can be important in situations where you want to avoid transaction propagation and ensure strict isolation of database operations.</p>
<p>Here is an example of using <code>@Transactional(propagation = Propagation.REQUIRES_NEW)</code> in a Spring Boot application:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// Update user details</span></span><br><span class="line">        updateUserDetails(user);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Log the update operation in a separate transaction</span></span><br><span class="line">        logUserUpdate(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(propagation = Propagation.REQUIRES_NEW)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">logUserUpdate</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="comment">// Log the update operation</span></span><br><span class="line">        <span class="comment">// This will run in a separate transaction</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Important considerations when using REQUIRES_NEW:</p>
<p><strong>Performance Overhead:</strong><br>Creating a new transaction has a performance overhead, so use it judiciously.</p>
<p><strong>Connection Pool Exhaustion:</strong><br>If overused, it can lead to connection pool exhaustion as each new transaction requires its own connection</p>
<h2 id="NESTED"><a href="#NESTED" class="headerlink" title="NESTED"></a>NESTED</h2><p>Setting propagation &#x3D; Propagation.NESTED indicates that the annotated method should execute in a nested transaction. If there is an existing transaction, the method will create a savepoint within that transaction. If there is no existing transaction, a new transaction will be started.</p>
<p>NESTED propagation is useful in scenarios where you want to create a nested transaction within an existing transaction. This allows you to have a savepoint within the outer transaction, so that if the nested transaction fails, you can roll back only the changes made within the nested transaction, while still keeping the changes made in the outer transaction intact. This can be helpful in complex business logic scenarios where you need to ensure atomicity and consistency of multiple related operations within a larger transaction. An example use case for NESTED propagation is when you need to perform a series of database updates, and if any of the updates fail, you want to roll back only the changes made in that specific update, while still keeping the changes made in the previous updates.</p>
<h2 id="Difference-between-NESTED-and-REQUIRES-NEW"><a href="#Difference-between-NESTED-and-REQUIRES-NEW" class="headerlink" title="Difference between NESTED and REQUIRES_NEW"></a>Difference between NESTED and REQUIRES_NEW</h2><p>see <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/12390888/differences-between-requires-new-and-nested-propagation-in-spring-transactions">https://stackoverflow.com/a/12391308</a><br>PROPAGATION_REQUIRES_NEW starts a new, independent “inner” transaction for the given scope. This transaction will be committed or rolled back completely independent from the outer transaction, having its own isolation scope, its own set of locks, etc. The outer transaction will get suspended at the beginning of the inner one, and resumed once the inner one has completed. …</p>
<p>PROPAGATION_NESTED on the other hand starts a “nested” transaction, which is a true subtransaction of the existing one. What will happen is that a savepoint will be taken at the start of the nested transaction. Íf the nested transaction fails, we will roll back to that savepoint. The nested transaction is part of of the outer transaction, so it will only be committed at the end of of the outer transaction. …</p>
<h2 id="NOT-SUPPORTED"><a href="#NOT-SUPPORTED" class="headerlink" title="NOT_SUPPORTED"></a>NOT_SUPPORTED</h2><p>Setting propagation &#x3D; Propagation.NOT_SUPPORTED indicates that the annotated method should execute without a transaction. If there is an existing transaction, it will be suspended for the duration of the method execution.</p>
<p>NOT_SUPPORTED propagation is useful in scenarios where you want to run a method outside the scope of any transaction. This can be helpful when you want to perform read-only operations that do not require transactional support, or when you want to run a method that should not be affected by the current transaction context. An example use case for NOT_SUPPORTED propagation is when you need to perform a series of read-only database queries that do not require transactional support, or when you want to run a method that should not be affected by the current transaction context.</p>
<h2 id="NEVER"><a href="#NEVER" class="headerlink" title="NEVER"></a>NEVER</h2><p>Setting propagation &#x3D; Propagation.NEVER indicates that the annotated method should execute without a transaction. If there is an existing transaction, an exception will be thrown.</p>
<p>Use Case:<br>Use Propagation.NEVER when you want to guarantee that specific pieces of code are not executed within a transaction context. This can be useful when you want to ensure that certain operations are always executed outside the scope of any transaction, or when you want to prevent specific methods from being called within a transaction context. If a method annotated with Propagation.NEVER is called within a transaction context, an IllegalTransactionStateException will be thrown, preventing the method from executing.</p>
<p>Alternatives is to use Propogation.NOT_SUPPORTED, which will suspend the current transaction if one exists, and execute the method without a transaction. If no transaction exists, the method will be executed without a transaction. Propagation.NOT_SUPPORTED is more flexible than Propagation.NEVER, as it allows the method to be executed both within and outside a transaction context, while Propagation.NEVER strictly prohibits the method from being executed within a transaction context.</p>
<h1 id="Isolation"><a href="#Isolation" class="headerlink" title="Isolation"></a>Isolation</h1><p>The isolation level determines how much a transaction is isolated from other transactions. The following are the isolation levels:</p>
<ul>
<li>DEFAULT</li>
<li>READ_UNCOMMITTED</li>
<li>READ_COMMITTED</li>
<li>REPEATABLE_READ</li>
<li>SERIALIZABLE</li>
</ul>
<p>default isolation level is DEFAULT.</p>
<p>setting isolation level to READ_COMMITTED</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(isolation = Isolation.REPEATABLE_READ)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">  customerRepository.save(<span class="keyword">new</span> <span class="title class_">Customer</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Smith&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Read-Only"><a href="#Read-Only" class="headerlink" title="Read-Only"></a>Read-Only</h1><p>The read-only setting is used to specify whether the transaction is read-only. If the transaction is read-only, the transaction is optimized for read operations. The default setting is false.</p>
<p>setting read-only to true</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(readOnly = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">  customerRepository.save(<span class="keyword">new</span> <span class="title class_">Customer</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Smith&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="rollbackFor"><a href="#rollbackFor" class="headerlink" title="rollbackFor"></a>rollbackFor</h1><p>The rollbackFor setting is used to specify which exceptions trigger a rollback. By default, any RuntimeException or Error triggers a rollback. Any checked Exception does not trigger a rollback.</p>
<p>setting rollbackFor to IllegalArgumentException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = IllegalArgumentException.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">  customerRepository.save(<span class="keyword">new</span> <span class="title class_">Customer</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Smith&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="transactionManagers"><a href="#transactionManagers" class="headerlink" title="transactionManagers"></a>transactionManagers</h1><p>The transactionManager setting is used to specify the transaction manager to use. If not specified, the default transaction manager is used.</p>
<p>setting transactionManager to transactionManager2</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(transactionManager = &quot;transactionManager2&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveCustomer</span><span class="params">()</span> &#123;</span><br><span class="line">  customerRepository.save(<span class="keyword">new</span> <span class="title class_">Customer</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Smith&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Most Spring applications need only a single transaction manager, but there may be situations where you want multiple independent transaction managers in a single application.   You can use the value or transactionManager attribute of the @Transactional annotation to optionally specify the identity of the TransactionManager to be used. </p>
<h1 id="Spring-Transaction-or-Jakarta-Transaction"><a href="#Spring-Transaction-or-Jakarta-Transaction" class="headerlink" title="Spring Transaction or Jakarta Transaction"></a>Spring Transaction or Jakarta Transaction</h1><p>Should I use org.springframework.transaction.annotation.Transactional or jakarta.transaction.Transactional </p>
<p>The <code>jakarta.transaction.Transactional</code> annotation is a standard annotation defined in the Jakarta Transaction API. The <code>org.springframework.transaction.annotation.Transactional</code> annotation is a Spring-specific annotation that provides additional features beyond the standard <code>jakarta.transaction.Transactional</code> annotation. The Spring-specific <code>org.springframework.transaction.annotation.Transactional</code> annotation is more commonly used in Spring applications.</p>
<h1 id="CrudRepository-and-Transactional"><a href="#CrudRepository-and-Transactional" class="headerlink" title="CrudRepository and @Transactional"></a>CrudRepository and @Transactional</h1><p>When you use the CrudRepository interface to perform database operations, you do not need to use the @Transactional annotation. The CrudRepository interface automatically handles transactions for you. The CrudRepository interface provides built-in transaction management, so you do not need to explicitly define transactions using the @Transactional annotation when using CrudRepository. Spring Data aims to simplify transaction management by providing sensible defaults for CrudRepository methods.</p>
<p>Read operations (like findById(), findAll()) are also often transactional. Read operations are typically configured with @Transactional(readOnly &#x3D; true). This signals to the underlying database that the operation will not modify data, allowing for potential optimizations.</p>
<p>This means that operations like save(), delete(), and others that modify data are executed within a transaction. If an exception occurs during the operation, the transaction is rolled back, and the data is not saved.</p>
<p>It is also important to note that when adding your own methods to a repository, those methods will not automatically be transactional. You will need to add the @Transactional annotation to those methods yourself.</p>
<h1 id="Swallowing-Exception"><a href="#Swallowing-Exception" class="headerlink" title="Swallowing Exception"></a>Swallowing Exception</h1><p>Swallowing exceptions in a <strong><code>@Transactional</code></strong> method is generally <strong>not recommended</strong> because it can lead to <strong>unexpected behavior</strong>, such as:  </p>
<ol>
<li><p><strong>Transaction Not Rolling Back</strong>:  </p>
<ul>
<li>If you catch an exception and do not rethrow it, Spring may think everything is fine and <strong>commit</strong> the transaction instead of rolling it back.  </li>
<li>This can leave the database in an inconsistent state.</li>
</ul>
</li>
<li><p><strong>Debugging Becomes Harder</strong>:  </p>
<ul>
<li>If an exception is swallowed, it becomes difficult to trace the root cause of failures.  </li>
<li>Future errors may arise due to hidden issues, making debugging challenging.</li>
</ul>
</li>
</ol>
<h2 id="Example-of-a-Problematic-Approach"><a href="#Example-of-a-Problematic-Approach" class="headerlink" title="Example of a Problematic Approach"></a><strong>Example of a Problematic Approach</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processOrder</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> orderRepository.findById(orderId)</span><br><span class="line">                .orElseThrow(() -&gt; <span class="keyword">new</span> <span class="title class_">OrderNotFoundException</span>(<span class="string">&quot;Order not found&quot;</span>));</span><br><span class="line">        order.setStatus(<span class="string">&quot;PROCESSED&quot;</span>);</span><br><span class="line">        orderRepository.save(order);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// Swallowing the exception - BAD PRACTICE</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Something went wrong: &quot;</span> + e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Why is this bad?</strong></p>
<ul>
<li>If an error occurs, like a database constraint violation, the method continues <strong>without rollback</strong>.</li>
<li>The system may believe the order was processed successfully, but in reality, it wasn’t.</li>
</ul>
<h2 id="How-to-Handle-Exceptions-Properly-in-a-Transactional-Method"><a href="#How-to-Handle-Exceptions-Properly-in-a-Transactional-Method" class="headerlink" title="How to Handle Exceptions Properly in a Transactional Method"></a><strong>How to Handle Exceptions Properly in a Transactional Method</strong></h2><p><strong>1. Log and Rethrow the Exception</strong> (Recommended)<br>If you need to log the exception, <strong>log it and rethrow it</strong> to allow the transaction to roll back:  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processOrder</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> orderRepository.findById(orderId)</span><br><span class="line">                .orElseThrow(() -&gt; <span class="keyword">new</span> <span class="title class_">OrderNotFoundException</span>(<span class="string">&quot;Order not found&quot;</span>));</span><br><span class="line">        order.setStatus(<span class="string">&quot;PROCESSED&quot;</span>);</span><br><span class="line">        orderRepository.save(order);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;Error processing order &#123;&#125;: &#123;&#125;&quot;</span>, orderId, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">throw</span> e; <span class="comment">// Rethrow to ensure rollback</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>2. Handle Specific Exceptions and Decide on Rollback</strong><br>If you need to catch exceptions but still ensure rollback for certain ones:  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = &#123;OrderProcessingException.class, RuntimeException.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processOrder</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Order</span> <span class="variable">order</span> <span class="operator">=</span> orderRepository.findById(orderId)</span><br><span class="line">                .orElseThrow(() -&gt; <span class="keyword">new</span> <span class="title class_">OrderNotFoundException</span>(<span class="string">&quot;Order not found&quot;</span>));</span><br><span class="line">        order.setStatus(<span class="string">&quot;PROCESSED&quot;</span>);</span><br><span class="line">        orderRepository.save(order);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (OrderProcessingException e) &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;Business logic failure: &#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">        <span class="keyword">throw</span> e; <span class="comment">// Ensures rollback</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;Unexpected error: &#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Processing failed, transaction rolled back.&quot;</span>); <span class="comment">// Wrap and rethrow</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>The <code>rollbackFor</code> attribute ensures the transaction <strong>rolls back</strong> even for checked exceptions like <code>OrderProcessingException</code>.</li>
</ul>
<p><strong>3. Handle Exceptions Outside the Transactional Method</strong><br>A better practice is to handle exceptions <strong>at the service&#x2F;controller level</strong> instead of inside the transactional method:  </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processOrderWithHandling</span><span class="params">(Long orderId)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        orderService.processOrder(orderId); <span class="comment">// Transactional method</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (OrderProcessingException e) &#123;</span><br><span class="line">        logger.warn(<span class="string">&quot;Handled business exception: &#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;Critical error: &#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;System failure, please try again later.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>When Is It Okay to Swallow an Exception?</strong><br>There are rare cases where swallowing an exception inside a <code>@Transactional</code> method <strong>might</strong> be acceptable:</p>
<ul>
<li><strong>You don’t care about failures and want to continue execution.</strong></li>
<li><strong>You’re handling a non-critical operation (e.g., logging, audit entries).</strong></li>
</ul>
<p>Example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUserProfile</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    userRepository.save(user);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        notificationService.sendProfileUpdateEmail(user);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (EmailServiceException e) &#123;</span><br><span class="line">        logger.warn(<span class="string">&quot;Failed to send notification email, but proceeding anyway.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Here, failing to send an email should <strong>not</strong> roll back the transaction, so it’s safe to catch and ignore the exception.</li>
</ul>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a><strong>Conclusion</strong></h1><ul>
<li><strong>DO NOT swallow exceptions</strong> in transactional methods unless absolutely necessary.  </li>
<li><strong>Rethrow or wrap exceptions</strong> to ensure proper rollback.  </li>
<li><strong>Handle exceptions outside the transactional method</strong> if possible.  </li>
<li><strong>Use <code>rollbackFor</code> explicitly</strong> when dealing with checked exceptions.</li>
</ul>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/reference/data-access/transaction/declarative/annotations.html">Using @Transactional</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/AWS/LocalStack/" rel="prev" title="LocalStack">
                  <i class="fa fa-chevron-left"></i> LocalStack
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/SpringBoot/Spring-Boot-MySQL/" rel="next" title="Spring Boot - MySQL">
                  Spring Boot - MySQL <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-coffee"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xinghua Zhang</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  





</body>
</html>
